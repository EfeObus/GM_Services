{% extends "base.html" %}

{% block title %}Request Submitted - GM Services{% endblock %}

{% block extra_css %}
<style>
    .success-container {
        max-width: 600px;
        margin: 0 auto;
        text-align: center;
    }
    
    .success-icon {
        font-size: 4rem;
        color: #28a745;
        margin-bottom: 1rem;
    }
    
    .request-number {
        background: linear-gradient(135deg, #007bff, #0056b3);
        color: white;
        padding: 15px 20px;
        border-radius: 8px;
        font-size: 1.5rem;
        font-weight: bold;
        letter-spacing: 1px;
        margin: 20px 0;
        display: inline-block;
    }
    
    .details-card {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
        text-align: left;
    }
    
    .detail-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
        border-bottom: 1px solid #dee2e6;
    }
    
    .detail-row:last-child {
        border-bottom: none;
    }
    
    .detail-label {
        font-weight: 600;
        color: #495057;
    }
    
    .status-badge {
        background-color: #17a2b8;
        color: white;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.875rem;
        font-weight: 500;
    }
    
    .urgency-badge {
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.875rem;
        font-weight: 500;
    }
    
    .urgency-low { background-color: #d4edda; color: #155724; }
    .urgency-medium { background-color: #fff3cd; color: #856404; }
    .urgency-high { background-color: #f8d7da; color: #721c24; }
    .urgency-urgent { background-color: #f5c6cb; color: #721c24; }
    
    .next-steps {
        background: #e3f2fd;
        border-left: 4px solid #2196f3;
        padding: 20px;
        border-radius: 4px;
        margin: 20px 0;
    }
    
    .action-buttons .btn {
        margin: 5px;
    }
</style>
{% endblock %}

{% block content %}
<div class="container my-5">
    <div class="success-container">
        <!-- Success Header -->
        <div class="success-icon">
            <i class="fas fa-check-circle"></i>
        </div>
        
        <h1 class="text-success mb-3">Request Submitted Successfully!</h1>
        
        <p class="lead text-muted mb-4">
            Thank you for contacting GM Services. Your request has been received and we'll get back to you soon.
        </p>
        
        <!-- Request Number -->
        <div class="request-number">
            <i class="fas fa-ticket-alt me-2"></i>
            {{ service_request.request_number }}
        </div>
        
        <p class="text-muted">
            <strong>Please save this reference number</strong> for tracking your request.
        </p>
        
        <!-- Request Details -->
        <div class="details-card">
            <h5 class="text-primary mb-3">
                <i class="fas fa-info-circle me-2"></i>Request Details
            </h5>
            
            <div class="detail-row">
                <span class="detail-label">Request Type:</span>
                <span>{{ service_request.request_type.name }}</span>
            </div>
            
            <div class="detail-row">
                <span class="detail-label">Subject:</span>
                <span>{{ service_request.subject }}</span>
            </div>
            
            <div class="detail-row">
                <span class="detail-label">Status:</span>
                <span class="status-badge">{{ service_request.status.title() }}</span>
            </div>
            
            <div class="detail-row">
                <span class="detail-label">Priority:</span>
                <span class="urgency-badge urgency-{{ service_request.urgency }}">
                    {{ service_request.urgency.title() }}
                </span>
            </div>
            
            <div class="detail-row">
                <span class="detail-label">Submitted:</span>
                <span>{{ service_request.submitted_at.strftime('%B %d, %Y at %I:%M %p') }}</span>
            </div>
            
            <div class="detail-row">
                <span class="detail-label">Expected Response:</span>
                <span>
                    {% if service_request.preferred_response_time == 'within_1_hour' %}
                        Within 1 hour
                    {% elif service_request.preferred_response_time == 'within_24_hours' %}
                        Within 24 hours
                    {% else %}
                        Within a week
                    {% endif %}
                </span>
            </div>
            
            {% if service_request.customer_state %}
            <div class="detail-row">
                <span class="detail-label">Location:</span>
                <span>
                    {{ service_request.customer_city if service_request.customer_city else 'N/A' }}, 
                    {{ service_request.customer_state }}
                </span>
            </div>
            {% endif %}
        </div>
        
        <!-- Next Steps -->
        <div class="next-steps text-start">
            <h6 class="text-primary">
                <i class="fas fa-list-ol me-2"></i>What Happens Next?
            </h6>
            <ol class="mb-0">
                <li><strong>Acknowledgment:</strong> You'll receive an email confirmation shortly</li>
                <li><strong>Review:</strong> Our team will review your request and assign it to the right department</li>
                <li><strong>Response:</strong> We'll contact you via your preferred method within the expected timeframe</li>
                <li><strong>Resolution:</strong> We'll work with you to resolve your request promptly</li>
            </ol>
        </div>
        
        <!-- Action Buttons -->
        <div class="action-buttons mt-4">
            <a href="{{ url_for('services.track_request') }}" class="btn btn-primary">
                <i class="fas fa-search me-2"></i>Track This Request
            </a>
            
            <a href="{{ url_for('services.service_request_form') }}" class="btn btn-outline-secondary">
                <i class="fas fa-plus me-2"></i>Submit Another Request
            </a>
            
            <a href="{{ url_for('index') }}" class="btn btn-outline-primary">
                <i class="fas fa-home me-2"></i>Back to Home
            </a>
        </div>
        
        <!-- Contact Information -->
        <div class="mt-5 p-3 bg-light rounded">
            <h6 class="text-primary mb-3">
                <i class="fas fa-headset me-2"></i>Need Immediate Assistance?
            </h6>
            
            <div class="row text-center">
                <div class="col-md-4 mb-2">
                    <i class="fas fa-phone text-success me-2"></i>
                    <strong>Call:</strong><br>
                    <a href="tel:+234xxxxxxxxxx" class="text-decoration-none">+234 xxx xxxx xxx</a>
                </div>
                
                <div class="col-md-4 mb-2">
                    <i class="fas fa-envelope text-primary me-2"></i>
                    <strong>Email:</strong><br>
                    <a href="mailto:support@gmservices.com" class="text-decoration-none">support@gmservices.com</a>
                </div>
                
                <div class="col-md-4 mb-2">
                    <i class="fas fa-comments text-info me-2"></i>
                    <strong>Live Chat:</strong><br>
                    <a href="#" class="text-decoration-none">Start Chat Session</a>
                </div>
            </div>
        </div>
        
        <!-- Email Notification -->
        <div class="alert alert-info mt-4" role="alert">
            <i class="fas fa-envelope me-2"></i>
            <strong>Check Your Email:</strong> A confirmation email has been sent to 
            <strong>{{ service_request.customer_email }}</strong>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Auto-copy request number to clipboard when clicked
    const requestNumber = document.querySelector('.request-number');
    if (requestNumber) {
        requestNumber.style.cursor = 'pointer';
        requestNumber.title = 'Click to copy request number';
        
        requestNumber.addEventListener('click', function() {
            const textToCopy = '{{ service_request.request_number }}';
            navigator.clipboard.writeText(textToCopy).then(function() {
                // Show temporary success message
                const originalText = requestNumber.innerHTML;
                requestNumber.innerHTML = '<i class="fas fa-check me-2"></i>Copied!';
                requestNumber.style.background = '#28a745';
                
                setTimeout(function() {
                    requestNumber.innerHTML = originalText;
                    requestNumber.style.background = 'linear-gradient(135deg, #007bff, #0056b3)';
                }, 2000);
            }).catch(function(err) {
                console.error('Could not copy text: ', err);
            });
        });
    }
});
</script>
{% endblock %}